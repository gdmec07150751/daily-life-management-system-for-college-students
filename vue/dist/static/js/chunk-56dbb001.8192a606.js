(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-56dbb001"],{"0481":function(e,t,n){"use strict";var r=n("23e7"),a=n("a2bf"),i=n("7b0b"),l=n("07fa"),o=n("5926"),s=n("65f0");r({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,t=i(this),n=l(t),r=s(t,0);return r.length=a(r,t,t,n,0,void 0===e?1:o(e)),r}})},"07ac":function(e,t,n){var r=n("23e7"),a=n("6f53").values;r({target:"Object",stat:!0},{values:function(e){return a(e)}})},3482:function(e,t,n){var r=n("087d"),a=n("5c69"),i=n("4359"),l=n("6747");function o(){var e=arguments.length;if(!e)return[];var t=Array(e-1),n=arguments[0],o=e;while(o--)t[o-1]=arguments[o];return r(l(n)?i(n):[n],a(t,1))}e.exports=o},4069:function(e,t,n){var r=n("44d2");r("flat")},"4b51":function(e,t,n){"use strict";var r=n("5530"),a=n("3482"),i=n.n(a),l=n("51f5"),o=n.n(l),s=n("ded5"),c=n.n(s),u=n("13ea"),d=n.n(u);n("ac1f"),n("1276"),n("d81d"),n("d3b7"),n("159b"),n("b64b"),n("0481"),n("4069"),n("07ac"),n("b0c0");t["a"]={methods:{splitPerms:function(e){if(e){var t=e.split(",");if(t&&t.length>0)return t}return[]},joinPerms:function(e){if(d()(e))return"";var t=e.map((function(e){return c()(e,":")}));return c()(t,",")},flatPerms:function(e){var t=this,n=[];return Object.keys(e).forEach((function(r){var a=e[r]._permission;if(a)n=i()(n,[Object.values(a)].flat());else{var l=t.flatPerms(e[r]);l&&l.length>0&&(n=i()(n,l))}})),n},filterPermToCascader:function(e,t,n){var r=t[e],a=o()(n,(function(e){return e.label===r}));if(a>=0)this.filterPermToCascader(e+1,t,n[a].children);else{var i=e===t.length-1,l={value:r,label:r,children:i?null:[]};n&&n.push(l),i||this.filterPermToCascader(e+1,t,n[n.length-1].children)}},filterMenuToTable:function(e,t){var n=this,a=[];return e.forEach((function(i){var l;if(t||i.parentId||1!==i.type)if(t||i.parentId||0!==i.type)if(t&&t.id===i.parentId&&1===i.type){var o=n.filterMenuToTable(e,i);l=Object(r["a"])({},i),l.children=o}else if(t&&t.id===i.parentId&&0===i.type){var s=n.filterMenuToTable(e,i);l=Object(r["a"])({},i),l.children=s}else t&&t.id===i.parentId&&2===i.type&&(l=Object(r["a"])({},i));else{var c=n.filterMenuToTable(e,i);l=Object(r["a"])({},i),l.children=c}else{var u=n.filterMenuToTable(e,i);l=Object(r["a"])({},i),l.children=u}l&&(l.pid=i.id,a.push(l))})),a},filterMenuToTree:function(e,t){var n=this,r=[];return e.forEach((function(a){var i;if(2!==a.type){if(t||a.parentId||1!==a.type)if(t||a.parentId||0!==a.type){if(t&&t.id===a.parentId&&1===a.type)i={label:a.name};else if(t&&t.id===a.parentId&&0===a.type){var l=n.filterMenuToTree(e,a);i={label:a.name},i.children=l}}else{var o=n.filterMenuToTree(e,a);i={label:a.name},i.children=o}else i={label:a.name};i&&(i.id=a.id,r.push(i))}})),r},filterMenuHasPermsToTree:function(e,t){var n=this,r=[];return e.forEach((function(a){var i;if(t||a.parentId||1!==a.type)if(t||a.parentId||0!==a.type)if(t&&t.id===a.parentId&&1===a.type){var l=n.filterMenuHasPermsToTree(e,a);i={label:a.name},i.children=l}else if(t&&t.id===a.parentId&&0===a.type){var o=n.filterMenuHasPermsToTree(e,a);i={label:a.name},i.children=o}else t&&t.id===a.parentId&&2===a.type&&(i={label:a.name});else{var s=n.filterMenuHasPermsToTree(e,a);i={label:a.name},i.children=s}else{var c=n.filterMenuHasPermsToTree(e,a);i={label:a.name},i.children=c}i&&(i.id=a.id,r.push(i))})),r},filterDeptToTree:function(e,t){var n=this,r=[];return e.forEach((function(a){var i;if(t||a.parentId){if(t&&t.id===a.parentId){var l=n.filterDeptToTree(e,a);i={label:a.name},i.children=l}}else{var o=n.filterDeptToTree(e,a);i={label:a.name},i.children=o}i&&(i.id=a.id,r.push(i))})),r}}}},"689d":function(e,t,n){},"6f53":function(e,t,n){var r=n("83ab"),a=n("e330"),i=n("df75"),l=n("fc6a"),o=n("d1e7").f,s=a(o),c=a([].push),u=function(e){return function(t){var n,a=l(t),o=i(a),u=o.length,d=0,f=[];while(u>d)n=o[d++],r&&!s(a,n)||c(f,e?[n,a[n]]:a[n]);return f}};e.exports={entries:u(!0),values:u(!1)}},"972d":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"sys-menu-container"},[n("table-layout",[n("s-table",{ref:"roleTable",attrs:{"data-request":e.getRoleList,"show-pagination":"",stripe:"","row-key":"id",border:""},scopedSlots:e._u([{key:"prepend",fn:function(){return[n("el-button",{attrs:{size:"mini",type:"primary",disabled:!e.$auth("sys.role.add")},on:{click:e.handleAdd}},[e._v("新增")])]},proxy:!0}])},[n("el-table-column",{attrs:{prop:"id",label:"#",align:"center",width:"55"}}),n("el-table-column",{attrs:{prop:"name",label:"名称",align:"center",width:"200"}}),n("el-table-column",{attrs:{prop:"label",label:"标识",align:"center",width:"200"}}),n("el-table-column",{attrs:{prop:"remark",label:"备注",align:"center"}}),n("el-table-column",{attrs:{prop:"createdAt",label:"创建时间",align:"center"}}),n("el-table-column",{attrs:{prop:"updatedAt",label:"更新时间",align:"center"}}),n("el-table-column",{attrs:{label:"操作",width:"150",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"mini",type:"text",disabled:!e.$auth("sys.role.update")},on:{click:function(n){return e.handleEdit(t.row)}}},[e._v("编辑")]),n("warning-confirm-button",{attrs:{closed:e.handleRefresh,disabled:!e.$auth("sys.role.delete")},on:{confirm:function(n){e.handleDelete(t.row,n)}}},[e._v("删除")])]}}])})],1)],1),n("system-permission-role-form-dialog",{ref:"formDialog",on:{"save-success":e.handleRefresh}})],1)},a=[],i=n("1da1"),l=(n("96cf"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-dialog",{ref:"formDialog"})}),o=[],s=n("2909"),c=(n("b0c0"),n("d3b7"),n("159b"),n("99af"),n("4b51")),u={name:"SystemPermissionRoleFormDialog",mixins:[c["a"]],methods:{handleOpen:function(e,t,n){var r=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var i,l,o,s,c,u,d,f,p,h,m,b;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return i=n.showLoading,l=n.hideLoading,o=n.close,s=n.$refs,a.prev=1,i(),a.next=5,r.$api.sys.dept.list();case 5:return c=a.sent,u=c.data,a.next=9,r.$api.sys.menu.list();case 9:if(d=a.sent,f=d.data,t.menus.data=r.filterMenuHasPermsToTree(f,null),t.depts.data=r.filterDeptToTree(u,null),-1===e){a.next=24;break}return a.next=16,r.$api.sys.role.info({roleId:e});case 16:p=a.sent,h=p.data,t.name=h.roleInfo.name,t.label=h.roleInfo.label,t.remark=h.roleInfo.remark,m=h.menus,b=h.depts,m&&m.length>0&&m.forEach((function(e){var t=s.menuTree.getNode(e.menuId);t&&t.isLeaf&&s.menuTree.setChecked(t,!0)})),b&&b.length>0&&b.forEach((function(e){var t=s.deptTree.getNode(e.departmentId);t&&t.isLeaf&&s.deptTree.setChecked(t,!0)}));case 24:l(),a.next=30;break;case 27:a.prev=27,a.t0=a["catch"](1),o();case 30:case"end":return a.stop()}}),a,null,[[1,27]])})))()},handleSubmit:function(e,t,n){var r=this,a=n.close,i=n.done,l=n.$refs,o=this.getMenuTreeCheckedKeys(l),s=this.getDeptTreeCheckedKeys(l);t.menus=o,t.depts=s;var c=null;-1===e?c=this.$api.sys.role.add(t):(t.roleId=e,c=this.$api.sys.role.update(t)),c.then((function(e){r.$emit("save-success"),a()})).catch((function(){i()}))},getMenuTreeCheckedKeys:function(e){var t=e.menuTree.getCheckedKeys(),n=e.menuTree.getHalfCheckedKeys();return[].concat(Object(s["a"])(t),Object(s["a"])(n))},getDeptTreeCheckedKeys:function(e){var t=e.deptTree.getCheckedKeys(),n=e.deptTree.getHalfCheckedKeys();return[].concat(Object(s["a"])(t),Object(s["a"])(n))},open:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this.$refs.formDialog.open({title:"编辑角色",on:{open:function(n,r){e.handleOpen(t,n,r)},submit:function(n,r){e.handleSubmit(t,n,r)}},items:[{label:"名称",prop:"name",value:"",span:12,rules:{required:!0,trigger:"blur",message:"请输入角色名称"},component:{name:"el-input",attrs:{placeholder:"请输入角色名称"}}},{label:"标识",prop:"label",value:"",span:12,rules:{required:!0,trigger:"blur",message:"请输入标识"},component:{name:"el-input",attrs:{placeholder:"请输入标识"}}},{label:"备注",prop:"remark",value:"",component:{name:"el-input",props:{type:"textarea",rows:2}}},{label:"菜单权限",prop:"menus",span:12,value:{data:[]},component:function(e,t){var n=t.scope;return e("el-tree",{class:{"role-form-dialog-tree-container":!0},props:{data:n.menus.data,"show-checkbox":!0,"node-key":"id","highlight-current":!0,props:{children:"children",label:"label"}},ref:"menuTree"})}},{label:"部门权限",prop:"depts",span:12,value:{data:[]},component:function(e,t){var n=t.scope;return e("el-tree",{class:{"role-form-dialog-tree-container":!0},props:{data:n.depts.data,"show-checkbox":!0,"node-key":"id","highlight-current":!0,props:{children:"children",label:"label"}},ref:"deptTree"})}}]})}}},d=u,f=(n("bde1"),n("2877")),p=Object(f["a"])(d,l,o,!1,null,null,null),h=p.exports,m=n("fe2b"),b=n("fbbc"),v=n("ab09"),g={name:"SystemPermissionRole",components:{TableLayout:b["a"],STable:v["a"],WarningConfirmButton:m["a"],SystemPermissionRoleFormDialog:h},methods:{getRoleList:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var r,a,i,l;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.page,a=e.limit,n.next=3,t.$api.sys.role.page({page:r,limit:a});case 3:return i=n.sent,l=i.data,n.abrupt("return",{list:l.list,pagination:{total:l.pagination.total}});case 6:case"end":return n.stop()}}),n)})))()},handleRefresh:function(){this.$refs.roleTable.refresh()},handleAdd:function(){this.$refs.formDialog.open()},handleEdit:function(e){this.$refs.formDialog.open(e.id)},handleDelete:function(e,t){var n=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=t.done,i=t.close,r.prev=1,r.next=4,n.$api.sys.role.delete({roleIds:[e.id]});case 4:i(),r.next=10;break;case 7:r.prev=7,r.t0=r["catch"](1),a();case 10:case"end":return r.stop()}}),r,null,[[1,7]])})))()}}},y=g,T=Object(f["a"])(y,r,a,!1,null,null,null);t["default"]=T.exports},a2bf:function(e,t,n){"use strict";var r=n("da84"),a=n("e8b5"),i=n("07fa"),l=n("0366"),o=r.TypeError,s=function(e,t,n,r,c,u,d,f){var p,h,m=c,b=0,v=!!d&&l(d,f);while(b<r){if(b in n){if(p=v?v(n[b],b,t):n[b],u>0&&a(p))h=i(p),m=s(e,t,p,h,m,u-1)-1;else{if(m>=9007199254740991)throw o("Exceed the acceptable array length");e[m]=p}m++}b++}return m};e.exports=s},bde1:function(e,t,n){"use strict";n("689d")},ded5:function(e,t){var n=Array.prototype,r=n.join;function a(e,t){return null==e?"":r.call(e,t)}e.exports=a},fe2b:function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-button",{attrs:{size:e.size,type:e.buttonType,disabled:e.disabled},on:{click:function(t){return t.stopPropagation(),e._handleClick.apply(null,arguments)}}},[e._t("default")],2)},a=[],i={name:"WarningConfirmButton",props:{content:{type:String,default:"此操作无法恢复，是否继续？"},title:{type:String,default:"警告"},confirmButtonText:{type:String,default:"确定"},cancelButtonText:{type:String,default:"取消"},iconType:{type:String,default:"warning",validator:function(e){return-1!==["success","info","warning","error"].indexOf(e)}},size:{type:String,default:"mini"},buttonType:{type:String,default:"text"},disabled:{type:Boolean,default:!1},closed:{type:Function,default:function(){return function(){}}},cancel:{type:Function,default:function(){return function(){}}}},data:function(){return{loading:!1}},methods:{_handleClick:function(){var e=this;this.$confirm(this.content,this.title,{confirmButtonText:this.confirmButtonText,cancelButtonText:this.cancelButtonText,type:this.iconType,beforeClose:function(t,n,r){"confirm"===t?(n.confirmButtonLoading=!0,e.$emit("confirm",{close:function(){n.confirmButtonLoading=!1,r()},done:function(){n.confirmButtonLoading=!1}})):(n.confirmButtonLoading=!1,r())}}).then((function(t){e.closed()})).catch((function(t){e.cancel()}))}}},l=i,o=n("2877"),s=Object(o["a"])(l,r,a,!1,null,null,null);t["a"]=s.exports}}]);